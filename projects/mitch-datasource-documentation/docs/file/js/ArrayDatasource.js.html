<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl" href="../../">
  <title data-ice="title">js/ArrayDatasource.js | mitch-datasource-documentation</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  <script src="script/manual.js"></script>
<meta name="description" content="Documentation for mitch-datasource"><meta property="twitter:card" content="summary"><meta property="twitter:title" content="mitch-datasource-documentation"><meta property="twitter:description" content="Documentation for mitch-datasource"></head>
<body class="layout-container" data-ice="rootContainer">

<header>
  <a href="./">Home</a>
  
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
<a style="position:relative; top:3px;" href="https://github.com/deltoss/mitch-datasource"><img width="20px" src="./image/github.png"></a></header>

<nav class="navigation" data-ice="nav"><div>
  <ul>
    
  <li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/js/AjaxDatasource.js~AjaxDatasource.html">AjaxDatasource</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/js/ArrayDatasource.js~ArrayDatasource.html">ArrayDatasource</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/js/DatasourceBase.js~DatasourceBase.html">DatasourceBase</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/js/QueryBuilder.js~QueryBuilder.html">QueryBuilder</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-SortCallback">SortCallback</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-SortCallback">SortCallback</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-MultiColumnSearchArgs">MultiColumnSearchArgs</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-MultiColumnSortArgs">MultiColumnSortArgs</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-QueryStringOptions">QueryStringOptions</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-SerialiseToQueryObjectCallback">SerialiseToQueryObjectCallback</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-SerialiseToQueryStringCallback">SerialiseToQueryStringCallback</a></span></span></li>
</ul>
</div>
</nav>

<div class="content" data-ice="content"><h1 data-ice="title">js/ArrayDatasource.js</h1>
<pre class="source-code line-number raw-source-code"><code class="prettyprint linenums" data-ice="content">import DatasourceBase from &apos;./DatasourceBase&apos;;

/**
 * Datasource to manage an array of data.
 *
 * @example &lt;caption&gt;Basic Usage&lt;/caption&gt;
 *
 * import { ArrayDatasource } from &apos;mitch-datasource&apos;;
 *
 * async function exampleAsyncFunction() {
 *   let datasource = new ArrayDatasource({
 *     data: [
 *       {
 *         id: 1,
 *         firstName: &apos;John&apos;,
 *         lastName: &apos;Smith&apos;
 *       },
 *       {
 *         id: 2,
 *         firstName: &apos;Mary&apos;,
 *         lastName: &apos;Jane&apos;
 *       },
 *       // ... More
 *     ]
 *   });
 *   await datasource.update();
 *   console.log(`First page of data: ${JSON.stringify(datasource.data)}`);
 * }
 * exampleAsyncFunction();
 *
 * @example &lt;caption&gt;Sorting&lt;/caption&gt;
 *
 * import { ArrayDatasource } from &apos;mitch-datasource&apos;;
 *
 * async function exampleAsyncFunction() {
 *   let datasource = new ArrayDatasource({
 *     data: [
 *       {
 *         id: 1,
 *         firstName: &apos;John&apos;,
 *         lastName: &apos;Smith&apos;
 *       },
 *       {
 *         id: 2,
 *         firstName: &apos;Mary&apos;,
 *         lastName: &apos;Jane&apos;
 *       },
 *       // ... More
 *     ],
 *     sort: (data, sortArguments = { &apos;firstName&apos;: &apos;asc&apos; }) =&gt; {
 *       return mockSortLogic(data, sortArguments);
 *     }
 *   });
 *   await datasource.sort({ &apos;lastName&apos;: &apos;asc&apos; });
 *   console.log(`First page of sorted data: ${JSON.stringify(datasource.data)}`);
 * }
 * exampleAsyncFunction();
 *
 * @example &lt;caption&gt;Filtering&lt;/caption&gt;
 *
 * import { ArrayDatasource } from &apos;mitch-datasource&apos;;
 *
 * async function exampleAsyncFunction() {
 *   let datasource = new ArrayDatasource({
 *     data: [
 *       {
 *         id: 1,
 *         firstName: &apos;John&apos;,
 *         lastName: &apos;Smith&apos;
 *       },
 *       {
 *         id: 2,
 *         firstName: &apos;Mary&apos;,
 *         lastName: &apos;Jane&apos;
 *       },
 *       // ... More
 *     ],
 *     search: (data, searchText) =&gt; {
 *       return mockSearchLogic(data, searchText);
 *     }
 *   });
 *   await datasource.search(&apos;John Smith&apos;);
 *   console.log(`First page of filtered data: ${JSON.stringify(datasource.data)}`);
 * }
 * exampleAsyncFunction();
 */
class ArrayDatasource extends DatasourceBase {
  /**
   * ToDo: Callback function
   *
   * @typedef {Function} SortCallback
   * @param {DatasourceBase} datasource
   * The datasource to convert to a query object.
   * @returns {Object} The query object.
   */

  /**
   * ToDo: Callback function
   *
   * @typedef {Function} SortCallback
   * @param {DatasourceBase} datasource
   * The datasource to convert to a query object.
   * @returns {Object} The query object.
   */

  /**
   * The constructor, taking in an options object.
   * For more passable options, see
   * {@link DatasourceBase#constructor}
   * @override
   * @param {Array} options.data
   * The data array of items.
   * @param {Function} [options.search]
   * The search function callback, which
   * gets called when searching is requested.
   * @param {Function} [options.sort]
   * The sort function callback, which
   * gets called when sorting is requested.
   */
  constructor(options = {}) {
    const mergedOptions = {
      ...ArrayDatasource.prototype.defaults,
      ...options,
    };
    super(mergedOptions);
    /**
     * The raw, unfiltered, unsorted,
     * unpaginated set of data.
     *
     * @access private
     * @type {?Array}
     */
    this._rawData = mergedOptions.data;

    /**
     * The filtered, sorted set of data.
     * This is not paginated.
     * Extracted from the raw data
     * ({@link ArrayDatasource#_rawData})
     *
     * @access private
     * @type {?Array}
     */
    this._processedData = null;

    /**
     * The filtered, sorted, paginated set
     * of data. Extracted from the processed data
     * ({@link ArrayDatasource#_processedData})
     *
     * @access private
     * @type {?Array}
     */
    this._data = null;

    /**
     * The search callback, called
     * when search operations was
     * requested.
     *
     * @access private
     * @type {Function}
     */
    this._search = mergedOptions.search;

    /**
     * The sort callback, called
     * when sort operations was
     * requested.
     *
     * @access private
     * @type {Function}
     */
    this._sort = mergedOptions.sort;
  }

  /**
   * Extracts the processed set of data
   * (i.e sorted, filtered) from the
   * raw data provided.
   * @access private
   * @return {Array} The array of processed data items.
   */
  _getProcessedData() {
    if (!this._rawData) {
      return [];
    }
    let processedData = [...this._rawData];
    if (this.searchArguments) {
      processedData = this._search.call(this, processedData, this.searchArguments);
    } else if (this.searchText) {
      processedData = this._search.call(this, processedData, this.searchText);
    }
    if (this._sort &amp;&amp; this.sortArguments) {
      processedData = this._sort.call(this, processedData, this.sortArguments);
    }
    return processedData;
  }

  /**
   * Overrides for DatasourceBase
   */

  /**
   * @inheritdoc
   * @override
   * @type {Number}
   */
  get total() {
    if (this._processedData) {
      return this._processedData.length;
    }
    if (this._rawData) {
      return this._rawData.length;
    }
    return 0;
  }

  /**
   * @inheritdoc
   * @override
   * @type {?Array}
   */
  get data() {
    return this._data;
  }

  /**
   * @inheritdoc
   * @override
   */
  async _update() {
    if (!this._rawData) {
      return null;
    }
    this._processedData = this._getProcessedData();
    this._data = this._processedData.slice(this.offset, this.offset + this.size);
    return this._data;
  }
}

ArrayDatasource.prototype.defaults = {
  data: null,
  /* eslint-disable no-unused-vars */
  search(data, searchArguments) {
    return data;
  },
  sort(data, sortArguments) {
    return data;
  },
  /* eslint-enable no-unused-vars */
};

export default ArrayDatasource;
</code></pre>

</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(1.1.0)</span><img src="./image/esdoc-logo-mini-black.png"></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>
</body>
</html>
